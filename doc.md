# Инструкция

Во время исполнения тестового задания было реализовано два приложения [eshop-app](https://github.com/novomirskoy/eshop-app) и [eshop](https://github.com/novomirskoy/eshop).

Первое - это серверная часть, которая содержит основную логику, второе - клиентская часть, которая занимается отображением данных полученных от сервера.

## Eshop-app

Приложение имеет только одну точку входа, консольную команду php yii websocket-server localhost 1337, имя сервера и порт можно выбрать любыми, но на данный момент
лучше оставить так. Сердцем приложения является модуль [novomirskoy/websocket](https://github.com/novomirskoy/websocket). Он использует Ratchet и протокол WAMP v1.
Выбор пал именно на него, потому что мне была необходима поддержка RPC, также в нём присутствует поддержка роутинга.

## Eshop

Клиентское приложение написанное на Vuejs и использующее autobahnjs для взаимодействия с сервером по протоколу WAMP v1.

Чтобы запустить минимально жизнеспособное приложение необходимо:

1. Запустить команду ```composer install```
2. Создать в СУБД mysql бд eshop и пользователя developer с паролем developer
3. Запустить миграцию БД - ```php yii migrate```
4. Загрузить в базу два дампа из директории ```data/sql```
5. Файл config/console.php 33 и 34 - указать имя пользователя и пароль от yandex почты, для того чтобы иметь возможность отправлять письма(будь отдельный почтовый сервер это бы не понадобилось)
6. Файл config/dependencies/services.php 16 строка - указать почтовый адрес отправителя, иначе письма не будут отправляться.
7. Запустить приложение командой ```yii websocket-server localhost 1337```
8. В runtime/logger.log можно лицезреть логи работы websocket сервера

## Eshop

1. Запустить команду ```npm install```, а после установки всех зависимостей ```npm run build```
2. Выполнить команду ```php -S localhost:8080 -t .``` для того, чтобы лицезреть приложение в браузере без необходимости установки/настройки полноценного веб сервера

### Примечание

* Для конфигурирования серверной части использовался не совсем стандартный DI в Yii2 - ```/config/container.php```. Это связанно со сложным конфигурированием websocket сервера, ну или к моей любви к ZendServiceManager и SymfonyDi.
* В коде осталось много лишних файлов от шаблона yii2-basic, работе демона они не мешают.
* Все самое интересное находится в директориях:
    * vendor/novomirskoy/websocket
    * websocket
    * repositories
    * commands/WebsocketServerController.php
    * config/{container, websocket}.php
    * config/{websocket}
    * config/{dependencies}
* В клиентской части всё очень сильно упрощено(только минимальные сценарий), и некоторые вещи нарочно оставлены без внимания, иначе бы времени на реализацию ушло бы больше
* OAuth не реализовано :(